# 6장: 가비지 수집 기초

### 개요

흔히 GC라고 말하는 가비지 컬렉션에 대해서 알아봅니다. 가비지란 정확하게 어떤 것인지, 힙이라고 불리는 메모리 풀에 어떻게 저장되어 있는지, 가비지 컬렉션은 무엇인지 알아봅니다.

---

### GC가 준수해야할 것

- GC는 자바 환경에서 JVM이 실행하는 꽤 돋보이는 기능입니다. 하지만 최초엔 언어 수준에서 메모리를 핸들링하지 못하게 만들었다는 이유로 꽤 많은 반감이 있었다고 합니다.
    - 하지만 자바는 블루컬러를 위한 언어라고 불릴만큼 개발자의 생산성에 많은 심혈을 기울이고 있습니다. 따라서 굉장히 심오한 고민이 필요한 메모리 핸들링을 Garbage Collector에 위임했습니다. 아마 제가 직접 C에서 malloc() 같은 메서드를 통해 직접 메모리를 핸들링했다면 과연 이 책을 읽을 수 있었을지 의문이네요.
- GC의 구현체가 반드시 준수해야 하는 두 가지 원칙이 있습니다. 바로 알고리즘은 반드시 모든 가비지를 수집해야만 한다는 것과 살아있는 객체를 수집해서는 안된다는 것입니다.
    - 살아있는 객체를 수집하는 건 프로그램에게 허용되지 않은 메모리 접근을 시도할 때 발생하는 **세그먼테이션 결함**을 유발합니다. 또한 프로그램의 데이터가 오염되는 결과도 발생하죠.

---

### GC의 기초, MS(Mark and Sweep)

- 있는 그대로 해석해보면 ‘표시해서 청소하기'입니다. GC의 가비지 수집의 기초는 해석한 그대로입니다. 살아있지 않다고 판단되는 놈들을 마크해서 그 녀석이 위치한 메모리를 재사용할 수 있도록 치우는 것입니다. 이것이 GC의 기본 메커니즘입니다.
    - 이 때 GC의 대상이 되는 ‘회수되지 않은 객체'를 보관하기 위해선 할당 리스트라는 배열을 사용합니다.
    - 살아있는 객체는 DFS 방식으로 탐색하고, 이를 통해 생성된 그래프는 **라이브 객체 그래프(Live Object Graph)**라고 부릅니다.

